% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/KNN.R
\name{MVKNN}
\alias{MVKNN}
\title{Multivariate KNN (MVKNN) Estimation with Cross-Validation}
\usage{
MVKNN(
  phenotype,
  genotype,
  input.kernel = NULL,
  MINQUE.type = "MINQUE0",
  KNN.type = "KNN",
  phenotype.type = "Heter",
  lambda = NULL,
  lambda.list = NULL,
  weight = NULL,
  fixed.effects = NULL,
  constrain = FALSE,
  cv.criteria = "COR",
  variance.component.list = NULL,
  thresh = 1e-05,
  max.iter = 100
)
}
\arguments{
\item{phenotype}{Matrix of phenotypes (N x d), where N is the number of samples and d is the number of traits.}

\item{genotype}{List of N x p genotype matrices.}

\item{input.kernel}{List specifying the kernel function(s) for each genotype matrix.}

\item{MINQUE.type}{Type of MINQUE estimator ('MINQUE0' or 'MINQUE1') (default 'MINQUE0').}

\item{KNN.type}{Type of KNN model ('KNN', 'LMM') (default 'KNN').}

\item{phenotype.type}{Phenotype covariance structure ('Homo' for homogeneous, 'Heter' for heterogeneous) (default 'Heter').}

\item{lambda}{Regularization parameter. If NULL, cross-validation will be performed.}

\item{lambda.list}{List of lambda values to try in cross-validation (used only if lambda is NULL).}

\item{weight}{Optional weight vector for variance components.}

\item{fixed.effects}{Optional fixed effects design matrix.}

\item{constrain}{Logical indicating whether to constrain variance components to be non-negative (default FALSE).}

\item{cv.criteria}{Criterion for selecting optimal lambda in CV ('LOSS', 'MSE', 'COR') (default is 'LOSS').}

\item{variance.component.list}{Optional precomputed list of variance components.}

\item{thresh}{Convergence threshold for iterative methods (default 1e-5).}

\item{max.iter}{Maximum number of iterations (default 100).}
}
\value{
A list containing estimated variance components (\code{theta}), phenotype covariance matrix (\code{phenotype.covariance}),
fixed effects (\code{beta}), and other matrices.
}
\description{
Estimates variance components and phenotype covariance in a multivariate KNN model.
If lambda is not specified, performs cross-validation to select optimal lambda.
}
